import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs groupId="token-auth-method" queryString>
<TabItem value="client_secret_basic" label="Client Secret Basic">

The `$CLIENT_ID` and `$CLIENT_SECRET` are sent in the Basic Authorization header.

<Tabs groupId="token-platform" queryString>
<TabItem value="curl" label="Curl">

```bash title="/token"
curl https://auth-$REGION.beyondidentity.com/v1/tenants/$TENANT_ID/realms/$REALM_ID/applications/$APPLICATION_ID/token \
-X POST \
-H 'Authorization: Basic {base64($CLIENT_ID:$CLIENT_SECRET)}' \
-H "Content-Type: application/x-www-form-urlencoded" \
-d "grant_type=authorization_code&code=$CODE_FROM_AUTHORIZATION_RESPONSEcode_verifier=$CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST&redirect_uri=$REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST"
```

</TabItem>

<TabItem value="node" label="Node">

```javascript title="/token"
fetch(
  `https://auth-${REGION}.beyondidentity.com/v1/tenants/${TENANT_ID}/realms/${REALM_ID}/applications/${APPLICATION_ID}/token`,
  {
    method: 'POST',
    headers: {
      Authorization: `Basic ${base64(${CLIENT_ID}:${CLIENT_SECRET})}`,
    },
    body: new URLSearchParams({
      grant_type: 'authorization_code',
      code: `${CODE_FROM_AUTHORIZATION_RESPONSE}`,
      code_verifier: `${CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST}`,
      redirect_uri:
        `${REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST}`,
    }),
  }
);
```

</TabItem>
<TabItem value="python" label="Python">

```python title="/token"
import requests

headers = {
    'Authorization': 'Basic {base64(CLIENT_ID:CLIENT_SECRET)}',
}

data = {
    'grant_type': 'authorization_code',
    'code': 'CODE_FROM_AUTHORIZATION_RESPONSE',
    'code_verifier': 'CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST',
    'redirect_uri': 'REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST',
}

response = requests.post(
    'https://auth-REGION.beyondidentity.com/v1/tenants/TENANT_ID/realms/REALM_ID/applications/APPLICATION_ID/token',
    headers=headers,
    data=data,
)
```

</TabItem>
<TabItem value="go" label="Go">

```go title="/token"
package main

import (
	"fmt"
	"io/ioutil"
	"log"
	"net/http"
	"strings"
)

func main() {
	client := &http.Client{}
	var data = strings.NewReader(`grant_type=authorization_code&code=CODE_FROM_AUTHORIZATION_RESPONSE&code_verifier=CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST&redirect_uri=REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST`)
	req, err := http.NewRequest("POST", "https://auth-REGION.beyondidentity.com/v1/tenants/TENANT_ID/realms/REALM_ID/applications/APPLICATION_ID/token", data)
	if err != nil {
		log.Fatal(err)
	}
	req.Header.Set("Authorization", "Basic {base64(CLIENT_ID:CLIENT_SECRET)}")
	req.Header.Set("Content-Type", "application/x-www-form-urlencoded")
	resp, err := client.Do(req)
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()
	bodyText, err := ioutil.ReadAll(resp.Body)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("%s\n", bodyText)
}
```

</TabItem>
</Tabs>
</TabItem>
<TabItem value="client_secret_post" label="Client Secret Post">

The `$CLIENT_ID` and `$CLIENT_SECRET` are sent in the body of the POST request as a form parameter.

<Tabs groupId="token-platform" queryString>

<TabItem value="curl" label="Curl">

```bash title="/token"
curl https://auth-$REGION.beyondidentity.com/v1/tenants/$TENANT_ID/realms/$REALM_ID/applications/$APPLICATION_ID/token \
-X POST \
-H "Content-Type: application/x-www-form-urlencoded" \
-F "grant_type=authorization_code" \
-F "code=$CODE_FROM_AUTHORIZATION_RESPONSE" \
-F "client_id=$CLIENT_ID" \
-F "client_secret=$CLIENT_SECRET_FROM_CONFIDENTIAL_APPLICATION" \
-F "code_verifier=$CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST" \
-F "redirect_uri=$REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST"
```

</TabItem>

<TabItem value="node" label="Node">

```javascript title="/token"
const form = new FormData();
form.append('grant_type', 'authorization_code');
form.append('code', `${CODE_FROM_AUTHORIZATION_RESPONSE}`);
form.append('client_id', `${CLIENT_ID}`);
form.append('client_secret', `${CLIENT_SECRET_FROM_CONFIDENTIAL_APPLICATION}`);
form.append(
  'code_verifier',
  `${CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST}`
);
form.append(
  'redirect_uri',
  `${REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST}`
);

fetch(
  `https://auth-${REGION}.beyondidentity.com/v1/tenants/${TENANT_ID}/realms/${REALM_ID}/applications/${APPLICATION_ID}/token`,,
  {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: form,
  }
);
```

</TabItem>
<TabItem value="python" label="Python">

```python title="/token"
import requests

headers = {
    'Content-Type': 'application/x-www-form-urlencoded',
}

files = {
    'grant_type': (None, 'authorization_code'),
    'code': (None, 'CODE_FROM_AUTHORIZATION_RESPONSE'),
    'client_id': (None, 'CLIENT_ID'),
    'client_secret': (None, 'CLIENT_SECRET_FROM_CONFIDENTIAL_APPLICATION'),
    'code_verifier': (None, 'CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST'),
    'redirect_uri': (None, 'REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST'),
}

response = requests.post(
    'https://auth-REGION.beyondidentity.com/v1/tenants/TENANT_ID/realms/REALM_ID/applications/APPLICATION_ID/token',
    headers=headers,
    files=files,
)
```

</TabItem>
<TabItem value="go" label="Go">

```go title="/token"
package main

import (
	"bytes"
	"fmt"
	"io/ioutil"
	"log"
	"mime/multipart"
	"net/http"
)

func main() {
	form := new(bytes.Buffer)
	writer := multipart.NewWriter(form)
	formField, err := writer.CreateFormField("grant_type")
	if err != nil {
		log.Fatal(err)
	}
	_, err = formField.Write([]byte("authorization_code"))

	formField, err = writer.CreateFormField("code")
	if err != nil {
		log.Fatal(err)
	}
	_, err = formField.Write([]byte("CODE_FROM_AUTHORIZATION_RESPONSE"))

	formField, err = writer.CreateFormField("client_id")
	if err != nil {
		log.Fatal(err)
	}
	_, err = formField.Write([]byte("CLIENT_ID"))

	formField, err = writer.CreateFormField("client_secret")
	if err != nil {
		log.Fatal(err)
	}
	_, err = formField.Write([]byte("CLIENT_SECRET_FROM_CONFIDENTIAL_APPLICATION"))

	formField, err = writer.CreateFormField("code_verifier")
	if err != nil {
		log.Fatal(err)
	}
	_, err = formField.Write([]byte("CODE_VERIFIER_IF_USED_PKCE_IN_AUTHORIZATION_REQUEST"))

	formField, err = writer.CreateFormField("redirect_uri")
	if err != nil {
		log.Fatal(err)
	}
	_, err = formField.Write([]byte("REDIRECT_URI_MUST_MATCH_VALUE_USED_IN_AUTHORIZATION_REQUEST"))

	writer.Close()

	client := &http.Client{}
	req, err := http.NewRequest("POST", "https://auth-REGION.beyondidentity.com/v1/tenants/TENANT_ID/realms/REALM_ID/applications/APPLICATION_ID/token", form)
	if err != nil {
		log.Fatal(err)
	}
	req.Header.Set("Content-Type", writer.FormDataContentType())
	resp, err := client.Do(req)
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()
	bodyText, err := ioutil.ReadAll(resp.Body)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("%s\n", bodyText)
}
```

</TabItem>
</Tabs>

</TabItem>
</Tabs>
